const hoursInput=document.getElementById("hours"),daysInput=document.getElementById("days"),nameInput=document.getElementById("name");function getNumsFromKebab(str,max=24){return str.split("-").map(Number).filter((n=>function isValidNumber(n,max=24){return!Number.isNaN(n)&&Number.isSafeInteger(n)&&n>=0&&n<max}(n,max))).sort(((a,b)=>a-b))}function redirectOut(){window.location.replace(`${window.location.origin}/c/`)}const keyNums=["0","1","2","3","4","5","6"];!function setHiddenInputs(){const{searchParams:searchParams}=new URL(window.location.href),hoursParam=searchParams.get("h");if(!hoursParam||hoursParam.length<1)return redirectOut();const hours=getNumsFromKebab(hoursParam,24),days=[];if(keyNums.forEach(((keyNum,index)=>{"1"===searchParams.get(`d${keyNum}`)&&days.push(index)})),days.length<1)return redirectOut();daysInput.value=days.join("-"),hoursInput.value=hours.join("-")}(),document.getElementById("form").addEventListener("submit",(ev=>{const name=nameInput.value,timestamps=function getTimestamps(days,hours){const timestamps=[],tomorrow=new Date;tomorrow.setDate(tomorrow.getDate()+1),tomorrow.setHours(0,0,1,0);const tomorrowsWeekDay=tomorrow.getDay();return days.forEach((dayNum=>{const date=new Date(tomorrow);dayNum>tomorrowsWeekDay?date.setDate(date.getDate()+dayNum-tomorrowsWeekDay):dayNum<tomorrowsWeekDay&&date.setDate(date.getDate()+(dayNum+(7-tomorrowsWeekDay))%7),hours.forEach((hourNum=>{date.setHours(hourNum),timestamps.push(date.getTime())}))})),timestamps}(getNumsFromKebab(daysInput.value,7),getNumsFromKebab(hoursInput.value,24)),poll={name:name,timestamps:timestamps};return console.log("poll:",poll),ev.preventDefault(),!1}));
